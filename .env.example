# ============================================================================
# C2-Phantom Production Security Configuration
# ============================================================================
# This file contains MANDATORY security settings for production deployment.
# CHANGE ALL DEFAULT VALUES BEFORE DEPLOYING TO PRODUCTION.
# ============================================================================

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ SERVER CONFIGURATION                                                     │
# └─────────────────────────────────────────────────────────────────────────┘

# Database connection (PostgreSQL)
# SECURITY: Use strong passwords, never expose to public internet
DATABASE_URL=postgres://c2phantom:CHANGE_THIS_PASSWORD@localhost:5432/c2phantom

# Redis connection (task queue and caching)
# SECURITY: Enable Redis password authentication in production
REDIS_URL=localhost:6379
REDIS_PASSWORD=

# Server bind addresses
HTTP_HOST=0.0.0.0
HTTP_PORT=8080
HTTPS_PORT=443

# TLS/SSL Configuration
# SECURITY: REQUIRED for production - use valid certificates
TLS_ENABLED=false
TLS_CERT_PATH=./certs/server.crt
TLS_KEY_PATH=./certs/server.key

# API Authentication
# SECURITY: Generate cryptographically secure API keys
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
API_KEY=c2phantom-admin-key-CHANGE_ME_NOW

# Session Security
# SECURITY: Use long random values (32+ bytes)
SESSION_SECRET=CHANGE_THIS_TO_RANDOM_64_CHAR_HEX_STRING
JWT_SECRET=CHANGE_THIS_TO_DIFFERENT_RANDOM_64_CHAR_HEX

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ OPERATIONAL SECURITY                                                     │
# └─────────────────────────────────────────────────────────────────────────┘

# Logging level: debug, info, warning, error
LOG_LEVEL=info

# Log retention (days)
LOG_RETENTION_DAYS=30

# Enable audit logging (all operations logged)
AUDIT_LOGGING=true

# Maximum concurrent agents
MAX_AGENTS=10000

# Agent timeout (seconds) - mark inactive if no beacon
AGENT_TIMEOUT=300

# Task timeout (seconds) - fail if not completed
TASK_TIMEOUT=600

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ RATE LIMITING & DOS PROTECTION                                          │
# └─────────────────────────────────────────────────────────────────────────┘

# Rate limiting: requests per minute per IP
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60

# Maximum request body size (bytes)
MAX_REQUEST_SIZE=10485760

# Connection timeout (seconds)
CONNECTION_TIMEOUT=30

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ ENCRYPTION & CRYPTOGRAPHY                                               │
# └─────────────────────────────────────────────────────────────────────────┘

# Default encryption algorithm: aes256, chacha20, aes128
DEFAULT_ENCRYPTION=aes256

# Encryption key rotation interval (hours)
KEY_ROTATION_HOURS=24

# Certificate pinning (comma-separated SHA256 fingerprints)
CERT_PINS=

# TLS minimum version: 1.2, 1.3
TLS_MIN_VERSION=1.2

# Allowed TLS ciphers (leave empty for secure defaults)
TLS_CIPHERS=

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ AGENT CONFIGURATION                                                      │
# └─────────────────────────────────────────────────────────────────────────┘

# Default beacon interval (seconds) - agent check-in frequency
AGENT_BEACON_INTERVAL=30

# Beacon jitter percentage (0-100) - randomize timing
AGENT_BEACON_JITTER=20

# Kill date - agents stop after this date (ISO format: 2026-12-31T23:59:59Z)
AGENT_KILL_DATE=

# Working hours - agents only active during these hours (format: 09:00-17:00)
AGENT_WORKING_HOURS=

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ NETWORK EVASION                                                          │
# └─────────────────────────────────────────────────────────────────────────┘

# Domain fronting target (CDN domain for traffic masking)
DOMAIN_FRONT_TARGET=

# User-Agent rotation (enable randomized user agents)
USER_AGENT_ROTATION=true

# Enable DNS tunneling fallback
DNS_TUNNELING=false
DNS_SERVER=8.8.8.8

# Proxy configuration (socks5://host:port or http://host:port)
PROXY_URL=

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ DATABASE SECURITY                                                        │
# └─────────────────────────────────────────────────────────────────────────┘

# Database connection pool size
DB_POOL_MIN=5
DB_POOL_MAX=25

# Database SSL mode: disable, require, verify-ca, verify-full
DB_SSL_MODE=require

# Database connection timeout (seconds)
DB_TIMEOUT=10

# Enable database encryption at rest (requires PostgreSQL with pgcrypto)
DB_ENCRYPTION=false

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ MONITORING & ALERTING                                                    │
# └─────────────────────────────────────────────────────────────────────────┘

# Enable Prometheus metrics endpoint
METRICS_ENABLED=false
METRICS_PORT=9090

# Webhook for security alerts (failed logins, suspicious activity)
ALERT_WEBHOOK=

# Email notifications (SMTP configuration)
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=c2phantom@localhost
ALERT_EMAIL=

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ ADVANCED SECURITY                                                        │
# └─────────────────────────────────────────────────────────────────────────┘

# Enable IP whitelisting (comma-separated IPs or CIDR ranges)
IP_WHITELIST=

# Enable geofencing (comma-separated country codes: US,UK,CA)
GEO_ALLOWED_COUNTRIES=

# Anti-VM detection (agents refuse to run in VMs)
ANTI_VM=false

# Anti-debugging (agents refuse to run if debugger detected)
ANTI_DEBUG=false

# Code obfuscation level: none, basic, advanced
OBFUSCATION_LEVEL=basic

# Memory encryption (encrypt sensitive data in memory)
MEMORY_ENCRYPTION=false

# Process hollowing detection prevention
PREVENT_PROCESS_HOLLOWING=true

# ┌─────────────────────────────────────────────────────────────────────────┐
# │ COMPLIANCE & LEGAL                                                       │
# └─────────────────────────────────────────────────────────────────────────┘

# Operator identification (required for audit trail)
OPERATOR_NAME=
OPERATOR_EMAIL=
OPERATOR_ORG=

# Engagement identifier (link operations to authorized tests)
ENGAGEMENT_ID=

# Compliance mode: training, testing, redteam, production
COMPLIANCE_MODE=training

# Data retention policy (days) - automatic cleanup
DATA_RETENTION_DAYS=90

# Enable legal hold (prevent data deletion during investigations)
LEGAL_HOLD=false

# ============================================================================
# SECURITY CHECKLIST (Mark completed items)
# ============================================================================
# [ ] Changed DATABASE_URL password
# [ ] Changed API_KEY to cryptographically secure value
# [ ] Changed SESSION_SECRET to random 64-character hex
# [ ] Changed JWT_SECRET to different random 64-character hex
# [ ] Generated valid TLS certificates
# [ ] Set TLS_ENABLED=true
# [ ] Configured IP_WHITELIST for server access
# [ ] Set RATE_LIMIT_ENABLED=true
# [ ] Configured ALERT_WEBHOOK or ALERT_EMAIL
# [ ] Set OPERATOR_NAME, OPERATOR_EMAIL, OPERATOR_ORG
# [ ] Set ENGAGEMENT_ID for authorized testing
# [ ] Reviewed and configured firewall rules
# [ ] Enabled database backups
# [ ] Set up monitoring and logging
# [ ] Documented incident response procedures
# ============================================================================
